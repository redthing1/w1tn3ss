w1_add_tracer(w1rewind
    SOURCES
        entrypoints/preload.cpp
        config/rewind_config.cpp
        engine/module_table_builder.cpp
        engine/register_schema.cpp
        engine/target_environment_provider.cpp
        engine/trace_emitter.cpp
        engine/rewind_engine.cpp
        thread/memory_access_builder.cpp
        thread/memory_filter.cpp
        thread/register_delta_builder.cpp
        thread/snapshot_builder.cpp
        thread/stack_window_policy.cpp
        thread/rewind_thread_tracer.cpp
    LIBS
        w1rewind_record
        w1rewind_trace
        w1::lief
)
